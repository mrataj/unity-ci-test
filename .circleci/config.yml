version: '2.1'
orbs:
  unity: game-ci/unity@1.3.0
workflows:
  test-build-with-executors:
    jobs:
      - unity/checkout
      - unity/test:
          context: unity
          executor:
            editor_version: 2021.3.16f1
            name: unity/ubuntu
            resource_class: medium
            target_platform: linux-il2cpp
          name: test-linux
          project-path: .
          step-name: Check if the tests run and results are uploaded
          test-platform: playmode
          unity-license-var-name: UNITY_ENCODED_LICENSE
          unity-password-var-name: UNITY_PASSWORD
          unity-username-var-name: UNITY_USERNAME
      - unity/build:
          build-target: StandaloneOSX
          compress: true
          context: unity
          executor:
            editor_version: 2021.3.16f1
            name: unity/macos
            resource_class: large
          name: build-osx-il2cpp
          project-path: ./
          requires:
            - test-osx
          step-name: Build macOS IL2CPP
          unity-license-var-name: UNITY_ENCODED_LICENSE
          unity-password-var-name: UNITY_PASSWORD
          unity-username-var-name: UNITY_USERNAME
